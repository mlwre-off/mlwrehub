-- GUI Module: создание интерфейса аутентификации ключа
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")

-- Создание ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "QUESTXGUI"
screenGui.IgnoreGuiInset = true
screenGui.ResetOnSpawn = false
screenGui.DisplayOrder = 999999
screenGui.ScreenInsets = Enum.ScreenInsets.None
screenGui.Parent = game.CoreGui

-- Фон (подложка)
local frame = Instance.new("Frame")
frame.Name = "MainFrame"
frame.Size = UDim2.fromScale(2, 2)
frame.Position = UDim2.fromScale(-0.5, -0.5)
frame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
frame.BackgroundTransparency = 0.3
frame.BorderSizePixel = 0
frame.ZIndex = 1
frame.Parent = screenGui

-- Центрированный контейнер для элементов GUI
local centerFrame = Instance.new("Frame")
centerFrame.Name = "CenterFrame"
centerFrame.Size = UDim2.new(0, 400, 0, 300)
centerFrame.Position = UDim2.new(0.5, -200, 0.5, -150)
centerFrame.BackgroundTransparency = 1
centerFrame.ZIndex = 2
centerFrame.Parent = screenGui

-- Функция для создания текстовой метки
local function createTextLabel(parent, text, position)
    local textLabel = Instance.new("TextLabel")
    textLabel.Size = UDim2.new(0, 200, 0, 30)
    textLabel.Position = position
    textLabel.Text = text
    textLabel.Font = Enum.Font.SourceSansBold
    textLabel.TextSize = 20
    textLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    textLabel.BackgroundTransparency = 1
    textLabel.TextXAlignment = Enum.TextXAlignment.Left
    textLabel.Parent = parent
    return textLabel
end

-- Функция для создания радиального загрузчика (loader)
local function createRadialLoader(parent, targetTextLabel, offsetX, offsetY)
    local loaderFrame = Instance.new("Frame")
    loaderFrame.Size = UDim2.new(0, 20, 0, 20)
    loaderFrame.BackgroundTransparency = 1
    loaderFrame.Parent = parent

    local loader = Instance.new("ImageLabel")
    loader.Image = "rbxassetid://128475940557433"
    loader.Size = UDim2.new(1, 0, 1, 0)
    loader.BackgroundTransparency = 1
    loader.ImageColor3 = Color3.fromRGB(255, 255, 255)
    loader.ImageTransparency = 0
    loader.Parent = loaderFrame

    loaderFrame.Position = UDim2.new(
        targetTextLabel.Position.X.Scale,
        targetTextLabel.Position.X.Offset + offsetX,
        targetTextLabel.Position.Y.Scale,
        targetTextLabel.Position.Y.Offset + offsetY
    )

    -- Запуск анимации вращения (бесконечная петля)
    local tweenInfo = TweenInfo.new(0.5, Enum.EasingStyle.Linear, Enum.EasingDirection.InOut, -1)
    local tween = TweenService:Create(loader, tweenInfo, {Rotation = 360})
    tween:Play()

    return loaderFrame
end

-- Функция для создания галочки (иконки подтверждения)
local function createGalka(parent, targetTextLabel, offsetX, offsetY)
    local galkaFrame = Instance.new("Frame")
    galkaFrame.Size = UDim2.new(0, 20, 0, 20)
    galkaFrame.BackgroundTransparency = 1
    galkaFrame.Parent = parent

    local galka = Instance.new("ImageLabel")
    galka.Image = "rbxassetid://134087386267100"
    galka.Size = UDim2.new(1, 0, 1, 0)
    galka.BackgroundTransparency = 1
    galka.ImageColor3 = Color3.fromRGB(255, 255, 255)
    galka.ImageTransparency = 0
    galka.Parent = galkaFrame

    galkaFrame.Position = UDim2.new(
        targetTextLabel.Position.X.Scale,
        targetTextLabel.Position.X.Offset + offsetX,
        targetTextLabel.Position.Y.Scale,
        targetTextLabel.Position.Y.Offset + offsetY
    )

    return galkaFrame
end

-- Пример создания временных текстовых меток и загрузчиков
local text1 = createTextLabel(screenGui, "Data fetching", UDim2.new(0.5, -60, 0.5, -45))
local loader1 = createRadialLoader(screenGui, text1, -30, 5)
text1.Text = "Data fetched!"
local galka1 = createGalka(screenGui, text1, -30, 5)

local text2 = createTextLabel(screenGui, "Loading Key System", UDim2.new(0.5, -60, 0.5, -25))
local loader2 = createRadialLoader(screenGui, text2, -30, 5)
text2.Text = "Loaded Key System!"
local galka2 = createGalka(screenGui, text2, -30, 5)

local text3 = createTextLabel(screenGui, "Waiting for you to key...", UDim2.new(0.5, -60, 0.5, -5))
local loader3 = createRadialLoader(screenGui, text3, -30, 5)
text3.Text = "Found your key!"
local galka3 = createGalka(screenGui, text3, -30, 5)

-- Создание заголовка и подзаголовка интерфейса
local titleLabel = Instance.new("TextLabel")
titleLabel.Text = "Quest X Key Authentication"
titleLabel.Font = Enum.Font.GothamBold
titleLabel.TextSize = 36
titleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
titleLabel.BackgroundTransparency = 1
titleLabel.Size = UDim2.new(1, 0, 0.2, 0)
titleLabel.Parent = centerFrame
titleLabel.TextTransparency = 0

local subtitleLabel = Instance.new("TextLabel")
subtitleLabel.Text = "Enter your key below to gain access:"
subtitleLabel.Font = Enum.Font.Gotham
subtitleLabel.TextSize = 20
subtitleLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
subtitleLabel.BackgroundTransparency = 1
subtitleLabel.Size = UDim2.new(1, 0, 0.1, 0)
subtitleLabel.Position = UDim2.new(0, 0, 0.2, 0)
subtitleLabel.Parent = centerFrame
subtitleLabel.TextTransparency = 0

-- Поле ввода ключа
local keyInput = Instance.new("TextBox")
keyInput.PlaceholderText = "Enter your key here"
keyInput.Font = Enum.Font.Gotham
keyInput.TextSize = 18
keyInput.TextColor3 = Color3.fromRGB(255, 255, 255)
keyInput.BackgroundColor3 = Color3.fromRGB(199, 10, 10)
keyInput.BackgroundTransparency = 0.3
keyInput.Size = UDim2.new(1, 0, 0.15, 0)
keyInput.Position = UDim2.new(0, 0, 0.35, 0)
keyInput.BorderSizePixel = 1
keyInput.Text = "Enter your key here"
keyInput.BorderColor3 = Color3.fromRGB(50, 50, 50)
keyInput.Parent = centerFrame
local inputCorner = Instance.new("UICorner")
inputCorner.CornerRadius = UDim.new(0, 10)
inputCorner.Parent = keyInput

-- Кнопка проверки ключа (без обработчика событий)
local verifyButton = Instance.new("TextButton")
verifyButton.Text = "Verify Key"
verifyButton.Font = Enum.Font.GothamBold
verifyButton.TextSize = 20
verifyButton.TextColor3 = Color3.fromRGB(255, 255, 255)
verifyButton.BackgroundColor3 = Color3.fromRGB(227, 16, 16)
verifyButton.BackgroundTransparency = 0.3
verifyButton.Size = UDim2.new(1, 0, 0.15, 0)
verifyButton.Position = UDim2.new(0, 0, 0.55, 0)
verifyButton.BorderSizePixel = 1
verifyButton.BorderColor3 = Color3.fromRGB(50, 50, 50)
verifyButton.Parent = centerFrame
local verifyCorner = Instance.new("UICorner")
verifyCorner.CornerRadius = UDim.new(0, 10)
verifyCorner.Parent = verifyButton

-- Кнопка "Get Key" (без обработчика событий)
local getKeyButton = Instance.new("TextButton")
getKeyButton.Text = "Get Key"
getKeyButton.Font = Enum.Font.GothamBold
getKeyButton.TextSize = 20
getKeyButton.TextColor3 = Color3.fromRGB(255, 255, 255)
getKeyButton.BackgroundColor3 = Color3.fromRGB(227, 16, 16)
getKeyButton.BackgroundTransparency = 0.3
getKeyButton.Size = UDim2.new(0.5, 0, 0.15, 0)
getKeyButton.Position = UDim2.new(0.25, 0, 0.75, 10)
getKeyButton.BorderSizePixel = 2
getKeyButton.BorderColor3 = Color3.fromRGB(199, 10, 10)
getKeyButton.Parent = centerFrame
local getKeyCorner = Instance.new("UICorner")
getKeyCorner.CornerRadius = UDim.new(0, 10)
getKeyCorner.Parent = getKeyButton

-- Метка статуса (для вывода сообщений)
local statusLabel = Instance.new("TextLabel")
statusLabel.Text = ""
statusLabel.Font = Enum.Font.Gotham
statusLabel.TextSize = 16
statusLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
statusLabel.BackgroundTransparency = 1
statusLabel.Size = UDim2.new(1, 0, 0.1, 0)
statusLabel.Position = UDim2.new(0, 0, 0.95, 0)
statusLabel.Parent = centerFrame

-- Кнопка закрытия (без обработчика)
local imageButton = Instance.new("ImageButton")
imageButton.Name = "Close"
imageButton.Size = UDim2.new(0, 30, 0, 30)
imageButton.Position = UDim2.new(0.5, -150, 0.5, -35)
imageButton.BackgroundTransparency = 1
imageButton.Image = "rbxassetid://76797312599260"
imageButton.Parent = centerFrame

-- Плавающая иконка (без обработчиков)
local floatingIcon = Instance.new("ImageButton", screenGui)
floatingIcon.BackgroundColor3 = Color3.fromRGB(20, 20, 23)
floatingIcon.Image = "rbxassetid://117511501336791"
floatingIcon.Size = UDim2.new(0.07388234883546829, 0, 0.1319999247789383, 0)
floatingIcon.Name = "FloatingIcon"
floatingIcon.Visible = false
floatingIcon.Position = UDim2.new(0.09859155118465424, 0, 0.01671314239501953, 0)
floatingIcon.Draggable = true
local floatCorner = Instance.new("UICorner", floatingIcon)
floatCorner.CornerRadius = UDim.new(0.25, 0)
local aspectRatioConstraint = Instance.new("UIAspectRatioConstraint", floatingIcon)
aspectRatioConstraint.AspectRatio = 0.9962615966796875

-- Обновление размеров фона по размеру камеры (GUI адаптивность)
RunService.RenderStepped:Connect(function()
    local viewportSize = workspace.CurrentCamera.ViewportSize
    frame.Size = UDim2.new(0, viewportSize.X * 2, 0, viewportSize.Y * 2)
    frame.Position = UDim2.new(0.5, -viewportSize.X, 0.5, -viewportSize.Y)
end)

-- Возвращаем созданный GUI (при необходимости можно использовать как модуль)
return screenGui
